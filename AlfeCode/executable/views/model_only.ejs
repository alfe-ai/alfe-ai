<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Settings</title>
  <link rel="stylesheet" href="/styles.css" />
  <style>
    body{
      font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial;
      display:flex;
      justify-content:center;
      background:#0b1120;
      color:#e2e8f0;
      min-height:100vh;
      margin:0;
      padding:32px 20px;
    }
    .card{
      background:rgba(15,23,42,0.9);
      padding:24px;
      border-radius:12px;
      border:1px solid rgba(71,85,105,0.4);
      width:min(520px, 100%);
      display:flex;
      flex-direction:column;
      gap:12px;
      box-shadow:0 20px 45px rgba(0,0,0,0.35);
    }
    .card h2{
      margin:0 0 6px 0;
    }
    select{font-size:1rem;padding:10px;margin:6px 0 0 0;width:100%;background:#0f172a;color:#e2e8f0;border:1px solid rgba(148,163,184,0.25);border-radius:8px;}
    label{font-size:0.85rem;color:#94a3b8;display:block;margin-top:8px;}
    .footer{
      margin-top:auto;
      padding-top:12px;
      border-top:1px solid rgba(148,163,184,0.12);
      color:#94a3b8;
      text-align:center;
      display:flex;
      justify-content:center;
      gap:8px;
    }
    .footer a{color:inherit;}
    .github-link-button{
      display:inline-flex;
      align-items:center;
      gap:0.4rem;
      padding:0.5rem 0.85rem;
      border-radius:12px;
      border:1px solid rgba(148,163,184,0.35);
      background:linear-gradient(135deg, rgba(148,163,184,0.12) 0%, rgba(51,65,85,0.18) 100%);
      color:inherit;
      font-weight:700;
      cursor:pointer;
      transition:border-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
    }
    .github-link-button:hover,
    .github-link-button:focus-visible{
      border-color:#a78bfa;
      transform:translateY(-1px);
      box-shadow:0 10px 22px rgba(124,58,237,0.22);
    }
    .github-link-icon svg{
      width:18px;
      height:18px;
      fill:currentColor;
      flex-shrink:0;
    }
    .support-ticket{
      padding:12px 14px;
      border-radius:12px;
      border:1px solid rgba(148,163,184,0.25);
      background:rgba(15,23,42,0.6);
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .support-ticket h3{
      margin:0;
      font-size:1rem;
      color:#e2e8f0;
    }
    .section-title{
      margin:0 0 6px 0;
      font-size:1rem;
      color:#e2e8f0;
    }
    .support-ticket p{
      margin:0;
      color:#cbd5f5;
      font-size:0.95rem;
    }
    .subscribe-button{
      align-self:flex-start;
      padding:0.5rem 0.9rem;
      border-radius:10px;
      border:1px solid rgba(167,139,250,0.7);
      background:linear-gradient(135deg, rgba(124,58,237,0.3) 0%, rgba(99,102,241,0.4) 100%);
      color:#f8fafc;
      font-weight:600;
      cursor:pointer;
      transition:transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
    }
    .subscribe-button:hover,
    .subscribe-button:focus-visible{
      transform:translateY(-1px);
      border-color:#c4b5fd;
      box-shadow:0 10px 22px rgba(124,58,237,0.22);
    }
    .subscribe-button--inline{
      padding:0.15rem 0.55rem;
      border-radius:8px;
      font-size:0.75rem;
      line-height:1.2;
      align-self:center;
    }
    .usage-locked{
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      gap:8px;
      font-size:0.85rem;
      color:#94a3b8;
    }
    .logout-button{
      align-self:flex-start;
      padding:0.5rem 0.9rem;
      border-radius:10px;
      border:1px solid rgba(148,163,184,0.5);
      background:rgba(15,23,42,0.6);
      color:#e2e8f0;
      font-weight:600;
      cursor:pointer;
      transition:transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
    }
    .logout-button:hover,
    .logout-button:focus-visible{
      transform:translateY(-1px);
      border-color:#f87171;
      box-shadow:0 10px 22px rgba(248,113,113,0.2);
    }
    .logout-feedback{
      font-size:0.75rem;
      color:#94a3b8;
    }
    .logout-feedback.success{
      color:#a7f3d0;
    }
    .logout-feedback.error{
      color:#fca5a5;
    }
    select option:disabled,
    select option.engine-option-disabled{
      color:#64748b;
    }
    .engine-feedback{
      font-size:0.85rem;
      color:#94a3b8;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .engine-feedback.success{
      color:#a7f3d0;
    }
    .engine-feedback.error{
      color:#fca5a5;
    }
    .engine-feedback.hidden{
      display:none;
    }
    .ui-settings-feedback{
      font-size:0.75rem;
      color:#94a3b8;
    }
    .ui-settings-feedback.success{
      color:#a7f3d0;
    }
    .ui-settings-feedback.error{
      color:#fca5a5;
    }
    .ui-settings-feedback.hidden{
      display:none;
    }
    .hidden{
      display:none !important;
    }
  </style>
</head>
<body>
  <div id="__alfe_root" style="width:100%;display:flex;flex-direction:column;align-items:center;">
  <div class="card">
    <h2>Settings</h2>
    <div>
      <h3 style="margin:0 0 6px 0;font-size:1rem;color:#e2e8f0;">Model</h3>
      <select id="modelSelect" disabled aria-disabled="true"></select>
    <div style="margin-top:8px;">
      <span id="defaultModelFeedback" class="default-model-feedback hidden" aria-live="polite"></span>
    </div>
    </div>
    <div style="margin-top:8px;">
      <label for="engineSelect">Engine</label>
      <select id="engineSelect">
        <option value="auto">Auto</option>
        <option value="qwen">Qwen</option>
        <option value="codex">[Pro] Codex</option>
      </select>
      <div style="margin-top:6px;">
        <span id="engineFeedback" class="engine-feedback hidden" aria-live="polite"></span>
      </div>
    </div>
    <p id="info" style="color:#94a3b8;margin:2px 0 8px 0;"></p>
    <% if (showGitLogButtonTarget) { %>
    <div style="margin-top:8px;">
      <label for="gitButtonSelect">Git Log Button Target</label>
      <select id="gitButtonSelect" style="width:100%;padding:10px;margin-top:6px;">
        <option value="git-log">Git Log</option>
        <option value="git-tree">Git Tree</option>
      </select>
    </div>
    <% } %>
    <h3 class="section-title">UI Settings</h3>
    <div class="support-ticket" aria-live="polite">
      <label style="font-weight:600;display:flex;align-items:center;gap:8px;">
        <input type="checkbox" id="submitOnEnterCheckbox" name="submitOnEnter">
        <span>Enter/Return submits prompt</span>
      </label>
      <span id="submitOnEnterFeedback" class="ui-settings-feedback hidden" aria-live="polite"></span>
      <label style="font-weight:600;display:flex;align-items:center;gap:8px;margin-top:8px;">
        <input type="checkbox" id="promptHintsCheckbox" name="promptHints">
        <span>Display prompt hint text</span>
      </label>
      <span id="promptHintsFeedback" class="ui-settings-feedback hidden" aria-live="polite"></span>
    </div>
    <% if (apiPanelEnabled) { %>
    <h3 class="section-title">API</h3>
    <div class="support-ticket" aria-live="polite">
    </div>
    <% } %>
    <h3 class="section-title">Support</h3>
    <div class="support-ticket" aria-live="polite">
      <p id="supportPlanNotice">You must be logged in to send a support ticket.</p>
      <button type="button" id="supportActionButton" class="subscribe-button" data-support-url="/support">Sign Up / Log In</button>
    </div>
    <div style="margin-top:8px;">
      <h3 style="margin:0 0 6px 0;font-size:1rem;color:#e2e8f0;">Usage</h3>
      <div class="support-ticket" aria-live="polite">
        <div style="display:flex;flex-direction:column;gap:12px;">
          <div>
            <h4 style="margin:0 0 6px 0;font-size:0.95rem;color:#e2e8f0;">Code</h4>
            <div id="codeUsageLimited" style="display:flex;align-items:center;gap:8px;">
              <div style="flex:1;height:6px;background:#1e293b;border-radius:999px;overflow:hidden;">
                <div style="height:100%;width:0%;background:#38bdf8;"></div>
              </div>
              <span id="codeUsageLimit" style="font-size:0.85rem;color:#94a3b8;white-space:nowrap;">0/100 code runs</span>
            </div>
            <hr style="border:0;border-top:1px solid #1e293b;margin:8px 0;">
            <div id="codeUsageUnlimited" class="hidden" style="display:flex;flex-direction:column;align-items:flex-start;gap:2px;">
              <span id="codeUsageUnlimitedText" style="font-size:0.85rem;color:#94a3b8;white-space:nowrap;">Code usage is Unlimited*</span>
              <span id="codeUsageUnlimitedNote" class="hidden" style="font-size:0.8rem;color:#94a3b8;">Unlimited usage may change. You may be rate-limited.</span>
            </div>
            <div id="proCodeUsageSection" class="hidden" style="margin-top:12px;">
              <h4 style="margin:0 0 6px 0;font-size:0.9rem;color:#e2e8f0;">Pro Code</h4>
              <span style="font-size:0.85rem;color:#94a3b8;">Code usage of Pro models.</span>
              <div id="proCodeUsageBar" style="display:flex;align-items:center;gap:8px;margin-top:6px;">
                <div style="flex:1;height:6px;background:#1e293b;border-radius:999px;overflow:hidden;">
                  <div style="height:100%;width:0%;background:#38bdf8;"></div>
                </div>
                <span id="proCodeUsageLimit" style="font-size:0.85rem;color:#94a3b8;white-space:nowrap;">n/10000 cycles</span>
              </div>
            </div>
          </div>
          <% if (searchEnabled2026) { %>
          <div>
            <h4 style="margin:0 0 6px 0;font-size:0.95rem;color:#e2e8f0;">Search</h4>
            <div id="searchUsageBar" class="hidden" style="display:flex;align-items:center;gap:8px;">
              <div style="flex:1;height:6px;background:#1e293b;border-radius:999px;overflow:hidden;">
                <div style="height:100%;width:0%;background:#38bdf8;"></div>
              </div>
              <span id="searchUsageLimit" style="font-size:0.85rem;color:#94a3b8;white-space:nowrap;">0/0 searches</span>
            </div>
            <div id="searchLockedNotice" class="usage-locked hidden">
              <span>You must be logged in to use Search.</span>
              <button type="button" class="subscribe-button subscribe-button--inline">Sign Up / Log In</button>
            </div>
          </div>
          <% } %>
          <% if (imagesEnabled2026) { %>
          <div>
            <h4 style="margin:0 0 6px 0;font-size:0.95rem;color:#e2e8f0;">Image Design</h4>
            <div id="imageUsageBar" class="hidden" style="display:flex;align-items:center;gap:8px;">
              <div style="flex:1;height:6px;background:#1e293b;border-radius:999px;overflow:hidden;">
                <div style="height:100%;width:0%;background:#38bdf8;"></div>
              </div>
              <span id="imageUsageLimit" style="font-size:0.85rem;color:#94a3b8;white-space:nowrap;">0/0 images</span>
            </div>
            <div id="imageLockedNotice" class="usage-locked hidden">
              <span>You must be logged in to use Image Design.</span>
              <button type="button" class="subscribe-button subscribe-button--inline">Sign Up / Log In</button>
            </div>
          </div>
          <% } %>
          <% if (showPrintifyUploadUsage) { %>
          <div>
            <h4 style="margin:0 0 6px 0;font-size:0.95rem;color:#e2e8f0;">Printify Upload</h4>
            <hr style="border:0;border-top:1px solid #1e293b;margin:8px 0;">
            <div id="printifyUsageUnlimited" style="display:flex;flex-direction:column;align-items:flex-start;gap:2px;">
              <span style="font-size:0.85rem;color:#94a3b8;white-space:nowrap;">Printify Upload usage is Unlimited*</span>
              <span style="font-size:0.8rem;color:#94a3b8;">Unlimited usage may change. You may be rate-limited.</span>
            </div>
          </div>
          <% } %>
        </div>
        <hr style="border:0;border-top:1px solid #1e293b;margin:12px 0 8px 0;">
        <p style="margin:12px 0 0 0;font-size:0.8rem;color:#94a3b8;">All limits are monthly.</p>
      </div>
    </div>
    <div id="accountPanel" class="hidden" style="margin-top:12px;">
      <h3 style="margin:0 0 6px 0;font-size:1rem;color:#e2e8f0;">Account</h3>
      <div class="support-ticket" aria-live="polite">
        <div style="display:flex;flex-direction:column;gap:10px;">
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <span style="font-size:0.85rem;color:#94a3b8;">Email</span>
            <span id="accountEmail" style="font-size:0.85rem;color:#e2e8f0;word-break:break-all;">—</span>
          </div>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <span style="font-size:0.85rem;color:#94a3b8;">Plan</span>
            <div style="display:flex;flex-direction:column;align-items:flex-end;gap:4px;">
              <select
                id="accountPlanSelect"
                aria-label="Account plan"
                style="font-size:0.85rem;color:#e2e8f0;background:#0f172a;border:1px solid #1e293b;border-radius:6px;padding:4px 8px;"
              >
                <option value="Logged-out Session">Logged-out Session</option>
                <option value="Free">Free</option>
                <option value="Lite">Lite</option>
                <option id="accountPlanPlusOption" value="Plus" disabled hidden>Plus</option>
                <option value="Pro">Pro</option>
              </select>
              <span id="accountPlanFeedback" class="hidden" style="font-size:0.75rem;color:#94a3b8;">Saved.</span>
            </div>
          </div>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <span style="font-size:0.85rem;color:#94a3b8;">Ever subscribed</span>
            <div style="display:flex;flex-direction:column;align-items:flex-end;gap:4px;">
              <select
                id="accountEverSubscribedSelect"
                aria-label="Ever subscribed"
                style="font-size:0.85rem;color:#e2e8f0;background:#0f172a;border:1px solid #1e293b;border-radius:6px;padding:4px 8px;"
              >
                <option value="false">False</option>
                <option value="true">True</option>
              </select>
              <span id="accountEverSubscribedFeedback" class="hidden" style="font-size:0.75rem;color:#94a3b8;">Saved.</span>
            </div>
          </div>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <span style="font-size:0.85rem;color:#94a3b8;">NodeAddress</span>
            <span style="font-size:0.85rem;color:#e2e8f0;word-break:break-all;">0.0.0.0</span>
          </div>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <span style="font-size:0.85rem;color:#94a3b8;">Session</span>
            <span id="accountSession" style="font-size:0.85rem;color:#e2e8f0;word-break:break-all;">—</span>
          </div>
        </div>
      </div>
      <div style="margin-top:12px;display:flex;flex-direction:column;gap:6px;align-items:flex-start;">
        <button type="button" id="logoutButton" class="logout-button">Log out</button>
        <span id="logoutFeedback" class="logout-feedback hidden" aria-live="polite"></span>
      </div>
    </div>
    <footer class="footer">
      <a href="/about.html" target="_blank" rel="noopener noreferrer">About</a>
      <span aria-hidden="true">|</span>
      <button
        type="button"
        class="github-link-button"
        onclick="window.open('https://github.com/alfe-ai','_blank','noopener,noreferrer');"
      >
        GitHub
        <span aria-hidden="true" class="github-link-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" focusable="false">
            <g weight="bold">
              <path d="M212.62,75.17A63.7,63.7,0,0,0,206.39,26,12,12,0,0,0,196,20a63.71,63.71,0,0,0-50,24H126A63.71,63.71,0,0,0,76,20a12,12,0,0,0-10.39,6,63.7,63.7,0,0,0-6.23,49.17A61.5,61.5,0,0,0,52,104v8a60.1,60.1,0,0,0,45.76,58.28A43.66,43.66,0,0,0,92,192v4H76a20,20,0,0,1-20-20,44.05,44.05,0,0,0-44-44,12,12,0,0,0,0,24,20,20,0,0,1,20,20,44.05,44.05,0,0,0,44,44H92v12a12,12,0,0,0,24,0V192a20,20,0,0,1,40,0v40a12,12,0,0,0,24,0V192a43.66,43.66,0,0,0-5.76-21.72A60.1,60.1,0,0,0,220,112v-8A61.5,61.5,0,0,0,212.62,75.17ZM196,112a36,36,0,0,1-36,36H112a36,36,0,0,1-36-36v-8a37.87,37.87,0,0,1,6.13-20.12,11.65,11.65,0,0,0,1.58-11.49,39.9,39.9,0,0,1-.4-27.72,39.87,39.87,0,0,1,26.41,17.8A12,12,0,0,0,119.82,68h32.35a12,12,0,0,0,10.11-5.53,39.84,39.84,0,0,1,26.41-17.8,39.9,39.9,0,0,1-.4,27.72,12,12,0,0,0,1.61,11.53A37.85,37.85,0,0,1,196,104Z"></path>
            </g>
          </svg>
        </span>
      </button>
    </footer>
  </div>
  </div>
  <script src="/JS/model_only.js"></script>
    <% if (showGitLogButtonTarget) { %>
    <script>
    (function(){
      try{
        const sel=document.getElementById('gitButtonSelect');
        const STORAGE_KEY='sterling.gitButtonTarget';
        function send(val){ try{ window.parent.postMessage({type:'sterling:settings', key:'gitButtonTarget', value:val}, '*'); }catch(e){} }
        const cur = (function(){ try{ return localStorage.getItem(STORAGE_KEY) || 'git-log'; }catch(e){ return 'git-log'; } })();
        if(sel) sel.value = cur;
        send(cur);
        if(sel){ sel.addEventListener('change', function(){ const v=sel.value; try{ localStorage.setItem(STORAGE_KEY, v); }catch(e){} send(v); }); }
      }catch(e){ /* noop */ }
    })();
    </script>
    <% } %>
    <script>
    (function(){
      try{
        const STORAGE_KEY_SUBMIT = 'submitOnEnter';
        const checkbox = document.getElementById('submitOnEnterCheckbox');
        const feedback = document.getElementById('submitOnEnterFeedback');
        let feedbackTimeout = null;
        function send(val){ try{ window.parent.postMessage({type:'sterling:settings', key:'submitOnEnter', value:val}, '*'); }catch(e){} }
        function clearFeedbackTimeout(){
          if (!feedbackTimeout) return;
          clearTimeout(feedbackTimeout);
          feedbackTimeout = null;
        }
        function showFeedback(message, type){
          if (!feedback) return;
          if (!message) {
            feedback.textContent = '';
            feedback.classList.add('hidden');
            feedback.classList.remove('success', 'error');
            return;
          }
          feedback.textContent = message;
          feedback.classList.remove('hidden', 'success', 'error');
          if (type === 'success') {
            feedback.classList.add('success');
          } else if (type === 'error') {
            feedback.classList.add('error');
          }
        }
        try{
          let cur = (function(){ try{ return localStorage.getItem(STORAGE_KEY_SUBMIT); }catch(e){ return null; } })();
          if (cur === null) { cur = 'true'; }
          if (checkbox) checkbox.checked = (cur === 'true');
          send(checkbox ? checkbox.checked : (cur === 'true'));
          if (checkbox) checkbox.addEventListener('change', function(){
            clearFeedbackTimeout();
            showFeedback('Saving...');
            try{ localStorage.setItem(STORAGE_KEY_SUBMIT, checkbox.checked ? 'true' : 'false'); }catch(e){}
            send(checkbox.checked);
            feedbackTimeout = setTimeout(function(){
              showFeedback('Saved', 'success');
              feedbackTimeout = null;
            }, 300);
          });
        }catch(e){ /* noop */ }
      }catch(e){ /* noop */ }
    })();
    </script>
    <script>
    (function(){
      try{
        const STORAGE_KEY_HINTS = 'showPromptHints';
        const checkbox = document.getElementById('promptHintsCheckbox');
        const feedback = document.getElementById('promptHintsFeedback');
        let feedbackTimeout = null;
        function send(val){ try{ window.parent.postMessage({type:'sterling:settings', key:'showPromptHints', value:val}, '*'); }catch(e){} }
        function clearFeedbackTimeout(){
          if (!feedbackTimeout) return;
          clearTimeout(feedbackTimeout);
          feedbackTimeout = null;
        }
        function showFeedback(message, type){
          if (!feedback) return;
          if (!message) {
            feedback.textContent = '';
            feedback.classList.add('hidden');
            feedback.classList.remove('success', 'error');
            return;
          }
          feedback.textContent = message;
          feedback.classList.remove('hidden', 'success', 'error');
          if (type === 'success') {
            feedback.classList.add('success');
          } else if (type === 'error') {
            feedback.classList.add('error');
          }
        }
        try{
          let cur = (function(){ try{ return localStorage.getItem(STORAGE_KEY_HINTS); }catch(e){ return null; } })();
          if (cur === null) { cur = 'true'; }
          if (checkbox) checkbox.checked = (cur === 'true');
          send(checkbox ? checkbox.checked : (cur === 'true'));
          if (checkbox) checkbox.addEventListener('change', function(){
            clearFeedbackTimeout();
            showFeedback('Saving...');
            try{ localStorage.setItem(STORAGE_KEY_HINTS, checkbox.checked ? 'true' : 'false'); }catch(e){}
            send(checkbox.checked);
            feedbackTimeout = setTimeout(function(){
              showFeedback('Saved', 'success');
              feedbackTimeout = null;
            }, 300);
          });
        }catch(e){ /* noop */ }
      }catch(e){ /* noop */ }
    })();
    </script>
    
</body>
</html>
