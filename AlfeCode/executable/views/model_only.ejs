<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Settings</title>
  <link rel="stylesheet" href="/styles.css" />
  <style>
    body{
      font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial;
      display:flex;
      justify-content:center;
      background:#0b1120;
      color:#e2e8f0;
      min-height:100vh;
      margin:0;
      padding:32px 20px;
    }
    .card{
      background:rgba(15,23,42,0.9);
      padding:24px;
      border-radius:12px;
      border:1px solid rgba(71,85,105,0.4);
      width:min(520px, 100%);
      display:flex;
      flex-direction:column;
      gap:12px;
      box-shadow:0 20px 45px rgba(0,0,0,0.35);
    }
    .card h2{
      margin:0 0 6px 0;
    }
    .settings-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .settings-header__title-wrap{
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .settings-header .logout-button{
      align-self:auto;
      margin:0;
      white-space:nowrap;
    }
    select{font-size:1rem;padding:10px;margin:6px 0 0 0;width:100%;background:#0f172a;color:#e2e8f0;border:1px solid rgba(148,163,184,0.25);border-radius:8px;}
    .account-meta-select:disabled{
      appearance:none;
      -webkit-appearance:none;
      -moz-appearance:none;
      background-image:none;
      padding-right:8px;
    }
    .account-meta-select:disabled::-ms-expand{
      display:none;
    }
    label{font-size:0.85rem;color:#94a3b8;display:block;margin-top:8px;}
    .footer{
      margin-top:auto;
      padding-top:12px;
      border-top:1px solid rgba(148,163,184,0.12);
      color:#94a3b8;
      text-align:center;
      display:flex;
      justify-content:center;
      gap:8px;
    }
    .footer a{color:inherit;}
    .github-link-button{
      display:inline-flex;
      align-items:center;
      gap:0.4rem;
      padding:0.5rem 0.85rem;
      border-radius:12px;
      border:1px solid rgba(148,163,184,0.35);
      background:linear-gradient(135deg, rgba(148,163,184,0.12) 0%, rgba(51,65,85,0.18) 100%);
      color:inherit;
      font-weight:700;
      cursor:pointer;
      transition:border-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
    }
    .github-link-button:hover,
    .github-link-button:focus-visible{
      border-color:#a78bfa;
      transform:translateY(-1px);
      box-shadow:0 10px 22px rgba(124,58,237,0.22);
    }
    .github-link-icon svg{
      width:18px;
      height:18px;
      fill:currentColor;
      flex-shrink:0;
    }
    .support-ticket{
      padding:12px 14px;
      border-radius:12px;
      border:1px solid rgba(148,163,184,0.25);
      background:rgba(15,23,42,0.6);
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .support-ticket h3{
      margin:0;
      font-size:1rem;
      color:#e2e8f0;
    }
    .section-title{
      margin:0 0 6px 0;
      font-size:1rem;
      color:#e2e8f0;
    }
    .support-ticket p{
      margin:0;
      color:#cbd5f5;
      font-size:0.95rem;
    }
    .subscribe-button{
      align-self:flex-start;
      padding:0.5rem 0.9rem;
      border-radius:10px;
      border:1px solid rgba(167,139,250,0.7);
      background:linear-gradient(135deg, rgba(124,58,237,0.3) 0%, rgba(99,102,241,0.4) 100%);
      color:#f8fafc;
      font-weight:600;
      cursor:pointer;
      transition:transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
    }
    .subscribe-button:hover,
    .subscribe-button:focus-visible{
      transform:translateY(-1px);
      border-color:#c4b5fd;
      box-shadow:0 10px 22px rgba(124,58,237,0.22);
    }
    .subscribe-button--inline{
      padding:0.15rem 0.55rem;
      border-radius:8px;
      font-size:0.75rem;
      line-height:1.2;
      align-self:center;
    }
    .usage-locked{
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      gap:8px;
      font-size:0.85rem;
      color:#94a3b8;
    }
    .logout-button{
      align-self:flex-start;
      padding:0.5rem 0.9rem;
      border-radius:10px;
      border:1px solid rgba(148,163,184,0.5);
      background:rgba(15,23,42,0.6);
      color:#e2e8f0;
      font-weight:600;
      cursor:pointer;
      transition:transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
    }
    .logout-button:hover,
    .logout-button:focus-visible{
      transform:translateY(-1px);
      border-color:#f87171;
      box-shadow:0 10px 22px rgba(248,113,113,0.2);
    }
    .logout-button--danger{
      border-color:rgba(248,113,113,0.8);
      background:rgba(127,29,29,0.45);
      color:#fee2e2;
    }
    .logout-button--danger:hover,
    .logout-button--danger:focus-visible{
      border-color:#fca5a5;
      box-shadow:0 10px 22px rgba(239,68,68,0.32);
    }
    .logout-feedback{
      font-size:0.75rem;
      color:#94a3b8;
    }
    .logout-feedback.success{
      color:#a7f3d0;
    }
    .logout-feedback.error{
      color:#fca5a5;
    }
    select option:disabled,
    select option.engine-option-disabled{
      color:#64748b;
    }
    .model-select-wrapper{
      position:relative;
      width:100%;
    }
    .model-select-button{
      width:100%;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid rgba(148,163,184,0.4);
      background:rgba(15,23,42,0.7);
      color:#e2e8f0;
      text-align:left;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      cursor:pointer;
      font-size:0.95rem;
    }
    .model-select-button:focus-visible{
      outline:2px solid rgba(59,130,246,0.7);
      outline-offset:2px;
    }
    .model-select-button__text{
      display:flex;
      align-items:center;
      gap:6px;
      flex-wrap:wrap;
    }
    .model-select-button__caret{
      color:#94a3b8;
      font-size:0.8rem;
    }
    .model-select-menu{
      position:absolute;
      top:calc(100% + 6px);
      left:0;
      right:0;
      max-height:260px;
      overflow:auto;
      border-radius:12px;
      border:1px solid rgba(148,163,184,0.25);
      background:rgba(6,8,15,0.98);
      box-shadow:0 18px 40px rgba(2,6,23,0.6);
      z-index:20;
      padding:6px;
    }
    .model-select-option{
      width:100%;
      padding:10px 12px;
      border-radius:10px;
      background:transparent;
      border:1px solid transparent;
      color:#e2e8f0;
      text-align:left;
      display:flex;
      flex-direction:column;
      gap:4px;
      cursor:pointer;
    }
    .model-select-option:hover{
      background:rgba(30,41,59,0.65);
      border-color:rgba(148,163,184,0.2);
    }
    .model-select-option.is-selected{
      border-color:transparent;
      background:transparent;
    }
    .model-select-option:disabled{
      cursor:not-allowed;
      color:#64748b;
      background:rgba(15,23,42,0.4);
    }
    .model-select-option.usage-limit-disabled{
      cursor:not-allowed;
      color:#64748b;
      background:rgba(124,58,237,0.25);
      border-color:rgba(124,58,237,0.35);
      opacity:0.7;
    }
    .model-select-option.usage-limit-disabled:hover{
      background:rgba(124,58,237,0.3);
      border-color:rgba(124,58,237,0.5);
    }
    .model-select-option__label{
      display:flex;
      align-items:center;
      flex-wrap:wrap;
      gap:6px;
      font-weight:600;
    }
    .model-select-option__meta{
      color:#94a3b8;
      font-size:0.8rem;
    }
    .model-select-native{
      position:absolute;
      left:-9999px;
      width:1px;
      height:1px;
      opacity:0;
      pointer-events:none;
    }
    .usage-badge{
      display:inline-flex;
      align-items:center;
      padding:2px 6px;
      border-radius:999px;
      font-size:0.7rem;
      font-weight:600;
      margin-left:6px;
      text-transform:none;
    }
    .usage-low{
      background:rgba(59,130,246,0.2);
      color:#93c5fd;
      border:1px solid rgba(59,130,246,0.4);
    }
    .usage-medium{
      background:rgba(250,204,21,0.2);
      color:#fde047;
      border:1px solid rgba(250,204,21,0.45);
    }
    .usage-high{
      background:rgba(249,115,22,0.2);
      color:#fb923c;
      border:1px solid rgba(249,115,22,0.45);
    }
    .usage-very-high{
      background:rgba(255,69,0,0.2);
      color:orangered;
      border:1px solid rgba(255,69,0,0.45);
    }
    .engine-feedback{
      font-size:0.85rem;
      color:#94a3b8;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .engine-feedback.success{
      color:#a7f3d0;
    }
    .engine-feedback.error{
      color:#fca5a5;
    }
    .engine-feedback.hidden{
      display:none;
    }
    .ui-settings-feedback{
      font-size:0.75rem;
      color:#94a3b8;
    }
    .ui-settings-feedback.success{
      color:#a7f3d0;
    }
    .ui-settings-feedback.error{
      color:#fca5a5;
    }
    .ui-settings-feedback.hidden{
      display:none;
    }
    .hidden{
      display:none !important;
    }
  </style>
</head>
<body>
  <div id="__alfe_root" style="width:100%;display:flex;flex-direction:column;align-items:center;">
  <div class="card">
    <div class="settings-header">
      <div class="settings-header__title-wrap">
        <h2>Settings</h2>
        <span id="logoutFeedback" class="logout-feedback hidden" aria-live="polite"></span>
      </div>
      <% if (account && account.email) { %>
      <button type="button" id="logoutButton" class="logout-button logout-button--danger">Log Out</button>
      <% } %>
    </div>
    <div style="<%= modelDropdownHidden ? 'display:none;' : '' %>">
      <h3 style="margin:0 0 6px 0;font-size:1rem;color:#e2e8f0;">Model</h3>
      <div class="model-select-wrapper">
        <button id="modelSelectButton" type="button" class="model-select-button" aria-haspopup="listbox" aria-expanded="false">
          <span class="model-select-button__text">Loading models…</span>
          <span class="model-select-button__caret">▼</span>
        </button>
        <div id="modelSelectMenu" class="model-select-menu hidden" role="listbox" aria-label="Model list"></div>
      </div>
      <select id="modelSelect" class="model-select-native" disabled aria-disabled="true"></select>
    <div style="margin-top:8px;">
      <span id="defaultModelFeedback" class="default-model-feedback hidden" aria-live="polite"></span>
    </div>
    </div>
    <% if (!engineDropdownHidden) { %>
    <div style="margin-top:8px;">
      <label for="engineSelect">Engine</label>
      <select id="engineSelect">
        <option value="auto">Auto</option>
        <option value="qwen">Qwen</option>
        <option value="codex">Codex</option>
        <option value="cline">Cline</option>
        <option value="sterling">Sterling</option>
        <option value="kilo">Kilo</option>
      </select>
      <div style="margin-top:6px;">
        <span id="engineFeedback" class="engine-feedback hidden" aria-live="polite"></span>
      </div>
    </div>
    <% } %>
    <p id="info" style="color:#94a3b8;margin:2px 0 8px 0;"></p>
    <% if (showGitLogButtonTarget) { %>
    <div style="margin-top:8px;">
      <label for="gitButtonSelect">Git Log Button Target</label>
      <select id="gitButtonSelect" style="width:100%;padding:10px;margin-top:6px;">
        <option value="git-log">Git Log</option>
        <option value="git-tree">Git Tree</option>
      </select>
    </div>
    <% } %>
    <h3 class="section-title">UI Settings</h3>
    <div class="support-ticket" aria-live="polite">
      <label style="font-weight:600;display:flex;align-items:center;gap:8px;">
        <input type="checkbox" id="submitOnEnterCheckbox" name="submitOnEnter">
        <span>Enter/Return submits prompt</span>
      </label>
      <span id="submitOnEnterFeedback" class="ui-settings-feedback hidden" aria-live="polite"></span>
      <label style="font-weight:600;display:flex;align-items:center;gap:8px;margin-top:8px;">
        <input type="checkbox" id="promptHintsCheckbox" name="promptHints">
        <span>Show prompt 'try' suggestions</span>
      </label>
      <span id="promptHintsFeedback" class="ui-settings-feedback hidden" aria-live="polite"></span>
      <label style="font-weight:600;display:flex;align-items:center;gap:8px;margin-top:8px;">
        <input type="checkbox" id="showDemoReposCheckbox" name="showDemoRepos">
        <span>Show Demo repositories in list</span>
      </label>
      <span id="showDemoReposFeedback" class="ui-settings-feedback hidden" aria-live="polite"></span>
      <label style="font-weight:600;display:flex;align-items:center;gap:8px;margin-top:8px;">
        <input type="checkbox" id="helpButtonVisibleCheckbox" name="helpButtonVisible">
        <span>Help (?) button on top right</span>
      </label>
      <span id="helpButtonVisibleFeedback" class="ui-settings-feedback hidden" aria-live="polite"></span>
      <label style="font-weight:600;display:flex;align-items:center;gap:8px;margin-top:8px;">
        <input type="checkbox" id="qwenShowDebugInfoCheckbox" name="qwenShowDebugInfo">
        <span>Qwen: Show debug [info]</span>
      </label>
      <span id="qwenShowDebugInfoFeedback" class="ui-settings-feedback hidden" aria-live="polite"></span>
    </div>
    <% if (apiPanelEnabled) { %>
    <h3 class="section-title">API</h3>
    <div class="support-ticket" aria-live="polite">
    </div>
    <% } %>
    <h3 class="section-title">Help and Support</h3>
    <div class="support-ticket" aria-live="polite">
      <a href="/help.html" class="subscribe-button">View Help Guide</a>
      <hr style="border:0;border-top:1px solid #1e293b;margin:8px 0;">
      <p id="supportPlanNotice">You must be logged in to send a support ticket.</p>
      <button type="button" id="supportActionButton" class="subscribe-button" data-support-url="/support">Sign Up / Log In</button>
    </div>
    <div style="margin-top:8px;">
      <h3 style="margin:0 0 6px 0;font-size:1rem;color:#e2e8f0;">Usage</h3>
      <div class="support-ticket" aria-live="polite">
        <div style="display:flex;flex-direction:column;gap:12px;">
          <div>
            <h4 style="margin:0 0 6px 0;font-size:0.95rem;color:#e2e8f0;">Code</h4>
            <div id="codeUsageLimited" style="display:flex;align-items:center;gap:8px;">
              <div style="flex:1;height:6px;background:#1e293b;border-radius:999px;overflow:hidden;">
                <div id="codeUsageBarFill" style="height:100%;width:0%;background:#38bdf8;"></div>
              </div>
              <span id="codeUsageLimit" style="font-size:0.85rem;color:#94a3b8;white-space:nowrap;">0/20 code runs</span>
            </div>
            <div id="freeCodeUsageUpsell" class="hidden" style="margin-top:8px;display:flex;flex-direction:column;align-items:flex-start;gap:6px;">
              <span style="font-size:0.95rem;color:#e2e8f0;font-weight:600;">Subscribe for Unlimited use.</span>
              <button type="button" class="subscribe-button subscribe-button--inline" data-cta-action="subscribe">Subscribe Now</button>
            </div>
            <div id="loggedOutCodeUsageUpsell" class="hidden" style="margin-top:8px;display:flex;flex-direction:column;align-items:flex-start;gap:6px;">
              <span style="font-size:0.95rem;color:#e2e8f0;font-weight:600;">Log in for increased limits.</span>
              <button type="button" class="subscribe-button subscribe-button--inline" data-cta-action="auth">Sign Up / Log In</button>
            </div>
            <hr id="codeUsageDivider" class="hidden" style="border:0;border-top:1px solid #1e293b;margin:8px 0;">
            <div id="codeUsageUnlimited" class="hidden" style="display:flex;flex-direction:column;align-items:flex-start;gap:2px;">
              <span id="codeUsageUnlimitedText" style="font-size:0.85rem;color:#94a3b8;white-space:nowrap;">Code usage is Unlimited*</span>
              <span id="codeUsageUnlimitedNote" class="hidden" style="font-size:0.8rem;color:#94a3b8;">Unlimited usage may change. You may be rate-limited.</span>
            </div>
            <div id="proCodeUsageSection" class="hidden" style="margin-top:12px;">
              <h4 style="margin:0 0 6px 0;font-size:0.9rem;color:#e2e8f0;">Pro Code</h4>
              <span style="font-size:0.85rem;color:#94a3b8;">Code usage of Pro models.</span>
              <div id="proCodeUsageBar" style="display:flex;align-items:center;gap:8px;margin-top:6px;">
                <div style="flex:1;height:6px;background:#1e293b;border-radius:999px;overflow:hidden;">
                  <div style="height:100%;width:0%;background:#38bdf8;"></div>
                </div>
                <span id="proCodeUsageLimit" style="font-size:0.85rem;color:#94a3b8;white-space:nowrap;">n/10000 cycles</span>
              </div>
            </div>
          </div>
          <% if (searchEnabled2026) { %>
          <div>
            <h4 style="margin:0 0 6px 0;font-size:0.95rem;color:#e2e8f0;">Search</h4>
            <div id="searchUsageBar" class="hidden" style="display:flex;align-items:center;gap:8px;">
              <div style="flex:1;height:6px;background:#1e293b;border-radius:999px;overflow:hidden;">
                <div style="height:100%;width:0%;background:#38bdf8;"></div>
              </div>
              <span id="searchUsageLimit" style="font-size:0.85rem;color:#94a3b8;white-space:nowrap;">0/0 searches</span>
            </div>
            <div id="searchLockedNotice" class="usage-locked hidden">
              <span>You must be logged in to use Search.</span>
              <button type="button" class="subscribe-button subscribe-button--inline" data-cta-action="auth">Sign Up / Log In</button>
            </div>
          </div>
          <% } %>
          <% if (imagesEnabled2026) { %>
          <div>
            <h4 style="margin:0 0 6px 0;font-size:0.95rem;color:#e2e8f0;">Image Design</h4>
            <div id="imageUsageBar" class="hidden" style="display:flex;align-items:center;gap:8px;">
              <div style="flex:1;height:6px;background:#1e293b;border-radius:999px;overflow:hidden;">
                <div style="height:100%;width:0%;background:#38bdf8;"></div>
              </div>
              <span id="imageUsageLimit" style="font-size:0.85rem;color:#94a3b8;white-space:nowrap;">0/0 images</span>
            </div>
            <div id="imageLockedNotice" class="usage-locked hidden">
              <span>You must be logged in to use Image Design.</span>
              <button type="button" class="subscribe-button subscribe-button--inline" data-cta-action="auth">Sign Up / Log In</button>
            </div>
          </div>
          <% } %>
          <% if (showPrintifyUploadUsage) { %>
          <div>
            <h4 style="margin:0 0 6px 0;font-size:0.95rem;color:#e2e8f0;">Printify Upload</h4>
            <hr style="border:0;border-top:1px solid #1e293b;margin:8px 0;">
            <div id="printifyUsageUnlimited" style="display:flex;flex-direction:column;align-items:flex-start;gap:2px;">
              <span style="font-size:0.85rem;color:#94a3b8;white-space:nowrap;">Printify Upload usage is Unlimited*</span>
              <span style="font-size:0.8rem;color:#94a3b8;">Unlimited usage may change. You may be rate-limited.</span>
            </div>
          </div>
          <% } %>
        </div>
        <hr style="border:0;border-top:1px solid #1e293b;margin:12px 0 8px 0;">
        <p style="margin:12px 0 0 0;font-size:0.8rem;color:#94a3b8;">All limits are monthly.</p>
      </div>
    </div>
    <div id="accountPanel" class="hidden" style="margin-top:12px;">
      <h3 style="margin:0 0 6px 0;font-size:1rem;color:#e2e8f0;">Account</h3>
      <div class="support-ticket" aria-live="polite">
        <div style="display:flex;flex-direction:column;gap:10px;">
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <span style="font-size:0.85rem;color:#94a3b8;">Email</span>
            <span id="accountEmail" style="font-size:0.85rem;color:#e2e8f0;word-break:break-all;">—</span>
          </div>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <span style="font-size:0.85rem;color:#94a3b8;">Plan</span>
            <div style="display:flex;flex-direction:column;align-items:flex-end;gap:4px;">
              <select
                id="accountPlanSelect"
                aria-label="Account plan"
                class="account-meta-select"
                style="font-size:0.85rem;color:#e2e8f0;background:#0f172a;border:1px solid #1e293b;border-radius:6px;padding:4px 8px;"
              >
                <option value="Logged-out Session">Logged-out Session</option>
                <option value="Free">Free</option>
                <option value="Lite">Subscribed</option>
                <option id="accountPlanPlusOption" value="Plus" disabled hidden>Plus</option>
                <option value="Pro" hidden>Pro</option>
              </select>
              <a
                id="manageSubscriptionButton"
                href="https://subscription.alfe.bot/customer_authentication/login?return_to=%2Ftools%2Fmemberships&locale=en&ui_hint=full&login_hint=<%= account && account.email ? encodeURIComponent(account.email) : '' %>"
                target="_blank"
                rel="noopener noreferrer"
                class="subscribe-button subscribe-button--inline hidden"
                style="align-self:flex-end;"
              >
                Manage Subscription
              </a>
              <span id="accountPlanFeedback" class="hidden" style="font-size:0.75rem;color:#94a3b8;">Saved.</span>
            </div>
          </div>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <span style="font-size:0.85rem;color:#94a3b8;">Ever subscribed</span>
            <div style="display:flex;flex-direction:column;align-items:flex-end;gap:4px;">
              <select
                id="accountEverSubscribedSelect"
                aria-label="Ever subscribed"
                class="account-meta-select"
                style="font-size:0.85rem;color:#e2e8f0;background:#0f172a;border:1px solid #1e293b;border-radius:6px;padding:4px 8px;"
                <%= allowAccountPlanEdit ? '' : 'disabled' %>
              >
                <option value="false">False</option>
                <option value="true">True</option>
              </select>
              <span id="accountEverSubscribedFeedback" class="hidden" style="font-size:0.75rem;color:#94a3b8;">Saved.</span>
            </div>
          </div>
          <% if (allowConfigIpControls) { %>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <span style="font-size:0.85rem;color:#94a3b8;">NodeAddress</span>
            <span style="font-size:0.85rem;color:#e2e8f0;word-break:break-all;">0.0.0.0</span>
          </div>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <span style="font-size:0.85rem;color:#94a3b8;">Openrouter.ai Key</span>
            <div style="display:flex;align-items:center;gap:6px;max-width:70%;justify-content:flex-end;">
              <span id="accountOpenrouterApiKey" style="font-size:0.85rem;color:#e2e8f0;word-break:break-all;text-align:right;">—</span>
              <button type="button" id="editOpenrouterApiKeyButton" aria-label="Edit Openrouter API key" title="Edit Openrouter API key" class="logout-button" style="padding:0.2rem 0.45rem;font-size:0.8rem;line-height:1;">✏️</button>
            </div>
          </div>
          <div style="display:flex;justify-content:flex-end;">
            <span id="accountOpenrouterApiKeyFeedback" class="hidden" style="font-size:0.75rem;color:#94a3b8;"></span>
          </div>
          <% } %>
          <div style="display:flex;justify-content:space-between;gap:12px;">
            <span style="font-size:0.85rem;color:#94a3b8;">Session</span>
            <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px;">
              <span id="accountSession" style="font-size:0.85rem;color:#e2e8f0;word-break:break-all;">—</span>
              <% if (allowConfigIpControls) { %>
              <button type="button" id="refreshSessionButton" class="logout-button" style="padding:0.35rem 0.7rem;font-size:0.75rem;">Refresh Session ID</button>
              <button type="button" id="resetUsageButton" class="logout-button" style="padding:0.35rem 0.7rem;font-size:0.75rem;">Reset Usage</button>
              <span id="refreshSessionFeedback" class="logout-feedback hidden" aria-live="polite"></span>
              <span id="resetUsageFeedback" class="logout-feedback hidden" aria-live="polite"></span>
              <% } %>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="footer">
      <% if (allowModelOrderEdit) { %>
      <a href="/agent/model-only/order">Edit model order</a>
      <span aria-hidden="true">|</span>
      <% } %>
      <% if (allowVmRunsLink) { %>
      <a href="/vm_runs">VM runs</a>
      <span aria-hidden="true">|</span>
      <% } %>
      <button
        type="button"
        class="github-link-button"
        onclick="window.open('/about.html','_blank','noopener,noreferrer');"
        oncontextmenu="window.open('/about.html','_blank','noopener,noreferrer'); return false;"
      >
        About
      </button>
      <span aria-hidden="true">|</span>
      <button
        type="button"
        class="github-link-button"
        onclick="window.open('https://github.com/alfe-ai','_blank','noopener,noreferrer');"
      >
        GitHub
        <span aria-hidden="true" class="github-link-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" focusable="false">
            <g weight="bold">
              <path d="M212.62,75.17A63.7,63.7,0,0,0,206.39,26,12,12,0,0,0,196,20a63.71,63.71,0,0,0-50,24H126A63.71,63.71,0,0,0,76,20a12,12,0,0,0-10.39,6,63.7,63.7,0,0,0-6.23,49.17A61.5,61.5,0,0,0,52,104v8a60.1,60.1,0,0,0,45.76,58.28A43.66,43.66,0,0,0,92,192v4H76a20,20,0,0,1-20-20,44.05,44.05,0,0,0-44-44,12,12,0,0,0,0,24,20,20,0,0,1,20,20,44.05,44.05,0,0,0,44,44H92v12a12,12,0,0,0,24,0V192a20,20,0,0,1,40,0v40a12,12,0,0,0,24,0V192a43.66,43.66,0,0,0-5.76-21.72A60.1,60.1,0,0,0,220,112v-8A61.5,61.5,0,0,0,212.62,75.17ZM196,112a36,36,0,0,1-36,36H112a36,36,0,0,1-36-36v-8a37.87,37.87,0,0,1,6.13-20.12,11.65,11.65,0,0,0,1.58-11.49,39.9,39.9,0,0,1-.4-27.72,39.87,39.87,0,0,1,26.41,17.8A12,12,0,0,0,119.82,68h32.35a12,12,0,0,0,10.11-5.53,39.84,39.84,0,0,1,26.41-17.8,39.9,39.9,0,0,1-.4,27.72,12,12,0,0,0,1.61,11.53A37.85,37.85,0,0,1,196,104Z"></path>
            </g>
          </svg>
        </span>
      </button>
    </footer>
  </div>
  </div>
  <script>
    window.MODEL_ONLY_CONFIG = {
      accountsEnabled: <%- JSON.stringify(typeof accountsEnabled === "undefined" ? true : accountsEnabled) %>,
      accountPlanEditable: <%- JSON.stringify(Boolean(allowAccountPlanEdit)) %>,
      allowConfigIpControls: <%- JSON.stringify(Boolean(allowConfigIpControls)) %>,
      qwenDebugEnabled: <%- JSON.stringify(typeof qwenDebugEnabled === "undefined" ? false : qwenDebugEnabled) %>,
    };
  </script>
  <script src="/JS/model_only.js"></script>
    <% if (showGitLogButtonTarget) { %>
    <script>
    (function(){
      try{
        const sel=document.getElementById('gitButtonSelect');
        const STORAGE_KEY='sterling.gitButtonTarget';
        function send(val){ try{ window.parent.postMessage({type:'sterling:settings', key:'gitButtonTarget', value:val}, '*'); }catch(e){} }
        const cur = (function(){ try{ return localStorage.getItem(STORAGE_KEY) || 'git-log'; }catch(e){ return 'git-log'; } })();
        if(sel) sel.value = cur;
        send(cur);
        if(sel){ sel.addEventListener('change', function(){ const v=sel.value; try{ localStorage.setItem(STORAGE_KEY, v); }catch(e){} send(v); }); }
      }catch(e){ /* noop */ }
    })();
    </script>
    <% } %>
    <script>
    (function(){
      try{
        const STORAGE_KEY_SUBMIT = 'submitOnEnter';
        const checkbox = document.getElementById('submitOnEnterCheckbox');
        const feedback = document.getElementById('submitOnEnterFeedback');
        let feedbackTimeout = null;
        function send(val){ try{ window.parent.postMessage({type:'sterling:settings', key:'submitOnEnter', value:val}, '*'); }catch(e){} }
        function clearFeedbackTimeout(){
          if (!feedbackTimeout) return;
          clearTimeout(feedbackTimeout);
          feedbackTimeout = null;
        }
        function showFeedback(message, type){
          if (!feedback) return;
          if (!message) {
            feedback.textContent = '';
            feedback.classList.add('hidden');
            feedback.classList.remove('success', 'error');
            return;
          }
          feedback.textContent = message;
          feedback.classList.remove('hidden', 'success', 'error');
          if (type === 'success') {
            feedback.classList.add('success');
          } else if (type === 'error') {
            feedback.classList.add('error');
          }
        }
        try{
          let cur = (function(){ try{ return localStorage.getItem(STORAGE_KEY_SUBMIT); }catch(e){ return null; } })();
          if (cur === null) { cur = 'true'; }
          if (checkbox) checkbox.checked = (cur === 'true');
          send(checkbox ? checkbox.checked : (cur === 'true'));
          if (checkbox) checkbox.addEventListener('change', function(){
            clearFeedbackTimeout();
            showFeedback('Saving...');
            try{ localStorage.setItem(STORAGE_KEY_SUBMIT, checkbox.checked ? 'true' : 'false'); }catch(e){}
            send(checkbox.checked);
            feedbackTimeout = setTimeout(function(){
              showFeedback('Saved', 'success');
              feedbackTimeout = null;
            }, 300);
          });
        }catch(e){ /* noop */ }
      }catch(e){ /* noop */ }
    })();
    </script>
    <script>
    (function(){
      try{
        const STORAGE_KEY_HINTS = 'showPromptHints';
        const checkbox = document.getElementById('promptHintsCheckbox');
        const feedback = document.getElementById('promptHintsFeedback');
        let feedbackTimeout = null;
        function send(val){ try{ window.parent.postMessage({type:'sterling:settings', key:'showPromptHints', value:val}, '*'); }catch(e){} }
        function clearFeedbackTimeout(){
          if (!feedbackTimeout) return;
          clearTimeout(feedbackTimeout);
          feedbackTimeout = null;
        }
        function showFeedback(message, type){
          if (!feedback) return;
          if (!message) {
            feedback.textContent = '';
            feedback.classList.add('hidden');
            feedback.classList.remove('success', 'error');
            return;
          }
          feedback.textContent = message;
          feedback.classList.remove('hidden', 'success', 'error');
          if (type === 'success') {
            feedback.classList.add('success');
          } else if (type === 'error') {
            feedback.classList.add('error');
          }
        }
        try{
          let cur = (function(){ try{ return localStorage.getItem(STORAGE_KEY_HINTS); }catch(e){ return null; } })();
          if (cur === null) { cur = 'true'; }
          if (checkbox) checkbox.checked = (cur === 'true');
          send(checkbox ? checkbox.checked : (cur === 'true'));
          if (checkbox) checkbox.addEventListener('change', function(){
            clearFeedbackTimeout();
            showFeedback('Saving...');
            try{ localStorage.setItem(STORAGE_KEY_HINTS, checkbox.checked ? 'true' : 'false'); }catch(e){}
            send(checkbox.checked);
            feedbackTimeout = setTimeout(function(){
              showFeedback('Saved', 'success');
              feedbackTimeout = null;
            }, 300);
          });
        }catch(e){ /* noop */ }
      }catch(e){ /* noop */ }
    })();
    </script>
    <script>
    (function(){
      try{
        const STORAGE_KEY_HELP_BUTTON = 'showHelpButton';
        const checkbox = document.getElementById('helpButtonVisibleCheckbox');
        const feedback = document.getElementById('helpButtonVisibleFeedback');
        let feedbackTimeout = null;
        function send(val){ try{ window.parent.postMessage({type:'sterling:settings', key:'showHelpButton', value:val}, '*'); }catch(e){} }
        function clearFeedbackTimeout(){
          if (!feedbackTimeout) return;
          clearTimeout(feedbackTimeout);
          feedbackTimeout = null;
        }
        function showFeedback(message, type){
          if (!feedback) return;
          if (!message) {
            feedback.textContent = '';
            feedback.classList.add('hidden');
            feedback.classList.remove('success', 'error');
            return;
          }
          feedback.textContent = message;
          feedback.classList.remove('hidden', 'success', 'error');
          if (type === 'success') {
            feedback.classList.add('success');
          } else if (type === 'error') {
            feedback.classList.add('error');
          }
        }
        try{
          let cur = (function(){ try{ return localStorage.getItem(STORAGE_KEY_HELP_BUTTON); }catch(e){ return null; } })();
          if (cur === null) { cur = 'true'; }
          if (checkbox) checkbox.checked = (cur === 'true');
          send(checkbox ? checkbox.checked : (cur === 'true'));
          if (checkbox) checkbox.addEventListener('change', function(){
            clearFeedbackTimeout();
            showFeedback('Saving...');
            try{ localStorage.setItem(STORAGE_KEY_HELP_BUTTON, checkbox.checked ? 'true' : 'false'); }catch(e){}
            send(checkbox.checked);
            feedbackTimeout = setTimeout(function(){
              showFeedback('Saved', 'success');
              feedbackTimeout = null;
            }, 300);
          });
        }catch(e){ /* noop */ }
      }catch(e){ /* noop */ }
    })();
    </script>
    <script>
    (function(){
      try{
        const STORAGE_KEY_QWEN_DEBUG_INFO = 'qwenShowDebugInfo';
        const checkbox = document.getElementById('qwenShowDebugInfoCheckbox');
        const feedback = document.getElementById('qwenShowDebugInfoFeedback');
        let feedbackTimeout = null;
        function send(val){ try{ window.parent.postMessage({type:'sterling:settings', key:'qwenShowDebugInfo', value:val}, '*'); }catch(e){} }
        function clearFeedbackTimeout(){
          if (!feedbackTimeout) return;
          clearTimeout(feedbackTimeout);
          feedbackTimeout = null;
        }
        function showFeedback(message, type){
          if (!feedback) return;
          if (!message) {
            feedback.textContent = '';
            feedback.classList.add('hidden');
            feedback.classList.remove('success', 'error');
            return;
          }
          feedback.textContent = message;
          feedback.classList.remove('hidden', 'success', 'error');
          if (type === 'success') {
            feedback.classList.add('success');
          } else if (type === 'error') {
            feedback.classList.add('error');
          }
        }
        try{
          let cur = (function(){ try{ return localStorage.getItem(STORAGE_KEY_QWEN_DEBUG_INFO); }catch(e){ return null; } })();
          if (cur === null) { cur = 'false'; }
          if (checkbox) checkbox.checked = (cur === 'true');
          send(checkbox ? checkbox.checked : (cur === 'true'));
          if (checkbox) checkbox.addEventListener('change', function(){
            clearFeedbackTimeout();
            showFeedback('Saving...');
            try{ localStorage.setItem(STORAGE_KEY_QWEN_DEBUG_INFO, checkbox.checked ? 'true' : 'false'); }catch(e){}
            send(checkbox.checked);
            feedbackTimeout = setTimeout(function(){
              showFeedback('Saved', 'success');
              feedbackTimeout = null;
            }, 300);
          });
        }catch(e){ /* noop */ }
      }catch(e){ /* noop */ }
    })();
    </script>
    <script>
    (function(){
      try{
        const STORAGE_KEY_DEMO_REPOS = 'showDemoRepos';
        const checkbox = document.getElementById('showDemoReposCheckbox');
        const feedback = document.getElementById('showDemoReposFeedback');
        let feedbackTimeout = null;
        function send(val){ try{ window.parent.postMessage({type:'sterling:settings', key:'showDemoRepos', value:val}, '*'); }catch(e){} }
        function clearFeedbackTimeout(){
          if (!feedbackTimeout) return;
          clearTimeout(feedbackTimeout);
          feedbackTimeout = null;
        }
        function showFeedback(message, type){
          if (!feedback) return;
          if (!message) {
            feedback.textContent = '';
            feedback.classList.add('hidden');
            feedback.classList.remove('success', 'error');
            return;
          }
          feedback.textContent = message;
          feedback.classList.remove('hidden', 'success', 'error');
          if (type === 'success') {
            feedback.classList.add('success');
          } else if (type === 'error') {
            feedback.classList.add('error');
          }
        }
        try{
          let cur = (function(){ try{ return localStorage.getItem(STORAGE_KEY_DEMO_REPOS); }catch(e){ return null; } })();
          if (cur === null) { cur = 'true'; }
          if (checkbox) checkbox.checked = (cur === 'true');
          send(checkbox ? checkbox.checked : (cur === 'true'));
          if (checkbox) checkbox.addEventListener('change', function(){
            clearFeedbackTimeout();
            showFeedback('Saving...');
            try{ localStorage.setItem(STORAGE_KEY_DEMO_REPOS, checkbox.checked ? 'true' : 'false'); }catch(e){}
            send(checkbox.checked);
            feedbackTimeout = setTimeout(function(){
              showFeedback('Saved', 'success');
              feedbackTimeout = null;
            }, 300);
          });
        }catch(e){ /* noop */ }
      }catch(e){ /* noop */ }
    })();
    </script>
    
</body>
</html>
